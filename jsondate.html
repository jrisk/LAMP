<html>
<head>
    <title>JSON AGENDA VIEW BUILD 2.0</title>
    <meta charset="UTF-8" name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script> 
<script src="http://code.jquery.com/ui/1.11.4/jquery-ui.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.10.3/moment.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.14.30/js/bootstrap-datetimepicker.min.js"></script>
<script src="https://raw.githubusercontent.com/enyo/dropzone/master/dist/dropzone.js"></script>
<script src="./extrajs.js"></script>

<!-- testing purposes <script src="./testing.js"></script> -->
<script src="//www.modernizr.com/downloads/modernizr-latest.js" type ="text/javascript"></script>

<link href="https://fonts.googleapis.com/css?family=Alegreya:400,700|Karla|Montserrat+Alternates:700" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.7.14/css/bootstrap-datetimepicker.min.css">
<link rel="stylesheet" href="./lessonplanner.css">
</head>

<body>
	<h2 id="plans"></h2>
	<div id="json-nest"></div>

</body>
<script>
$(function () {

	$.ajax({
		type: 'GET',
		url: 'datesort.php',
		success: function(data) {

			var JSONParse = JSON.parse(data);

			//var prettyString = JSON.stringify(parseString, undefined, 2);

			//$('#json-nest').html(prettyString);

			// very memory intensive looping here...considering refactoring,redoing

			/*JSONParse.sort(function (a,b) { // YOU CAN ONLY SORT AND ARRAY
				// YOU CAN NOT SORT A JSON OBJECT!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
				return a.start - b.start;
			});*/

			console.log(JSONParse);

			var iterplan = 0; // iterate only the specific

			$.each(JSONParse, function(i, obj) {

				/*for (i = 0; i < obj.length; i++) {
					if (obj[i].date < obj[++i].date) {
						return 1;
					}

					if (obj[++i].date < obj[i].date {
						return -1;
					}
				} */

				$('#plans').append('<h2 id="plan-day">' + obj[0].date + '</h2>');
				$('#plans').append('<h3 id="plan-' + obj[0].plan +
				'" class="well well-sm planstuffhere">' + obj[0].plan +
				'</h3>');

				//further seperate days into subplan-> activity combos

				for (i = 0; i < obj.length; i++) {

					var newtemp = obj[i].plan;

					if (newtemp == oldtemp) { // if current plan equals the last plan
						$('.' + stringpls).append('<h4 id="specificplan-' +
						obj[i].title + '" class="specplanners">' + obj[i].title + '</h4>');

					var oldtemp = obj[i].plan;

					}

					else { // it must be a new plan

						var stringpls = "planning" + newtemp.replace(/\s/g, "-");
						///always use the g flag to match ALL occurences, not just the first one

						$('#json-nest').append('<h1 class="' + stringpls + '">' +
							newtemp + '</h1><h3 id="specificplan-' +
							obj[i].title + '" class="the-first-act-for-' + newtemp + '">' + obj[i].title + '</h3>');

						var oldtemp = obj[i].plan;

					}

				}

				console.log(obj.length);
				
				for (j = 0; j < obj.length; j++) {

					var temp;

					temp = obj[j].plan;

					if (obj[j].plan == temp) {

					$('#plans').append('<div id="act-' + obj[j].id +
					'" class="well well-sm activity-well">' + obj[j].title + 'the plan: ' + obj[j].plan +
					'</div>');
					console.log(obj[j].title);

					}

					else {

						temp = obj[j].plan;

					$('#plans').append('<div id="act-' + obj[j].id +
					'" class="well well-sm activity-well">' + obj[j].title + "plan: " + obj[j].plan +
					'</div>');

					}
				}

				iterplan++;
			});

			console.log(iterplan);

			//$('.acts-group').hide();

			//$
		},
		error: function(errorThrown) {
			$('#json-nest').html(errorThrown);
		}
	});

})
</script>

</html>

